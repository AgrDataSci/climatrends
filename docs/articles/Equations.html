<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Equations used in climatrends • climatrends</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Equations used in climatrends">
<meta property="og:description" content="climatrends">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">climatrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.4-0003</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Climatology.html">Climatology data with climatrends</a>
    </li>
    <li>
      <a href="../articles/Equations.html">Equations used in climatrends</a>
    </li>
    <li>
      <a href="../articles/Overview.html">Introduction to climatrends</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/agrdatasci/climatrends/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Equations used in climatrends</h1>
                        <h4 data-toc-skip class="author">Kauê de
Sousa</h4>
            <address class="author_afil">
      Department of Agricultural Sciences, Inland Norway University,
Hamar, Norway  Digital Inclusion, Bioversity International,
Montpellier, France<br><small class="dont-index">Source: <a href="https://github.com/agrdatasci/climatrends/blob/HEAD/vignettes/Equations.Rmd" class="external-link"><code>vignettes/Equations.Rmd</code></a></small>
      <div class="hidden name"><code>Equations.Rmd</code></div>

    </address>
</div>

    
    
<p>Here I present a description of main equations used in the functions
available in the package <code>climatrends</code>.</p>
<div class="section level2">
<h2 id="growing-degree-days">Growing degree-days<a class="anchor" aria-label="anchor" href="#growing-degree-days"></a>
</h2>
<p>Growing degree-days (gdd) is an heuristic tool in phenology that
measures heat accumulation and is used to predict plant and animal
development rates<span class="citation"><sup>1</sup></span>. Growing
degree-days are calculated by taking the integral of warmth above a base
temperature (<span class="math inline">\(T_{0}\)</span>). The function
<code><a href="../reference/GDD.html">GDD()</a></code> applies by default the following equation.</p>
<p>Equation [1]</p>
<p><span class="math display">\[GDD = \frac{T_{max} + T_{min}}{2} -
T_{0}\]</span></p>
<p>where <span class="math inline">\(T_{max}\)</span> is the maximum
temperature in the given day, <span class="math inline">\(T_{min}\)</span> is the minimum temperature in the
given day and <span class="math inline">\(T_{0}\)</span> is the minimum
temperature for growth (as per the physiology of the focal organism or
ecosystem averages).</p>
<p>Additionally, the function <code><a href="../reference/GDD.html">GDD()</a></code> offers three modified
equations designed for cold environments and for tropical environments.
For cold environments, where <span class="math inline">\(T_{min}\)</span> may be lower than <span class="math inline">\(T_{0}\)</span>, there are two modified equations
that adjust either <span class="math inline">\(T_{mean}\)</span>
(variant a) or <span class="math inline">\(T_{min}\)</span> (variant b).
The variant a changes <span class="math inline">\(T_{mean}\)</span> to
<span class="math inline">\(T_{0}\)</span> if <span class="math inline">\(T_{mean} &lt; T_{0}\)</span> and is expressed as
follow.</p>
<p>Equation [2]</p>
<p><span class="math display">\[ GDD = max \left(\frac{T_{max} +
T_{min}}{2} - T_{0}, \; 0 \right)\]</span></p>
<p>The variant b, is calculated using Equation 1, but adjusts <span class="math inline">\(T_{min}\)</span> or <span class="math inline">\(T_{max}\)</span> to <span class="math inline">\(T_{0}\)</span> if <span class="math inline">\(T
&lt; T_{0}\)</span>, the equation is adjusted as follows.</p>
<p>Equation [3]</p>
<p><span class="math display">\[ T &lt; T_{0} \; \rightarrow \; T =
T_{0} \]</span></p>
<p>where <span class="math inline">\(T\)</span> may refer to <span class="math inline">\(T_{min}\)</span> and/or <span class="math inline">\(T_{max}\)</span> when the condition of being below
<span class="math inline">\(T_{0}\)</span> applies.</p>
<p>For tropical areas, where the temperature may surpass a maximum
threshold (<span class="math inline">\(T_{0_{max}}\)</span>), resulting
in limited development, the minimum temperature is adjusted using
Equation 3 and the maximum temperature is adjusted to a maximum base
temperature as follow.</p>
<p>Equation [4]</p>
<p><span class="math display">\[ T_{max} &gt; T_{0_{max}} \; \rightarrow
\; T_{max} = T_{0_{max}} \]</span></p>
<p>where <span class="math inline">\(T_{0_{max}}\)</span> is the maximum
base temperature for growth, defined in <code><a href="../reference/GDD.html">GDD()</a></code> using the
argument <code>tbase_max</code>.</p>
<p>These modified equations are defined as ‘a’, ‘b’ and ‘c’,
respectively, and can be selected using the argument
<code>equation</code>.</p>
<p>By default, the function returns the degree-days that is accumulated
over the time series using Equation 1. Additionally, the function may
return the daily values of degree-days or the number of days that a
given organism required to reach a certain number of accumulated
degree-days. These values are defined by ‘acc’, ‘daily’ or ‘ndays’ and
can be adjusted using the argument <code>return.as</code>. The required
accumulated gdd is defined with argument <code>degree.days</code>. For
example, the Korean pine (<em>Pinus koraiensis</em>) requires 105 <span class="math inline">\(^\circ C\)</span> accumulated gdd to onset the
photosynthesis<span class="citation"><sup>2</sup></span>. In that case,
<code><a href="../reference/GDD.html">GDD()</a></code> will calculate the growing degree-days (<span class="math inline">\(gdd\)</span>) and sum up the values until it
reaches 105 <span class="math inline">\(^\circ C\)</span> and return the
number of days required in the given season (<span class="math inline">\(GDD_{r}\)</span>), as follows.</p>
<div style="page-break-after: always;"></div>
<p>Equation [5]</p>
<p><span class="math display">\[\parallel GDD_{r} \parallel \: = \;
ggd_1 \;+ \; ...  \; +  \; gdd_n\]</span></p>
<p>where <span class="math inline">\(GDD_{r}\)</span> is the length of
the vector with accumulated degree-days from day 1 to <span class="math inline">\(n\)</span>.</p>
</div>
<div class="section level2">
<h2 id="late-spring-frost">Late-spring frost<a class="anchor" aria-label="anchor" href="#late-spring-frost"></a>
</h2>
<p>Late-spring frost is a freezing event occurring after a substantial
accumulation of warmth. Frost damage is a known issue in temperate and
boreal regions, it is associated with the formation of extracellular ice
crystals that cause damage in the membranes<span class="citation"><sup>3</sup></span>. Freezing occurring after an
advanced phenological stage during spring may harm some plant species,
resulting in lost of productivity in crop systems<span class="citation"><sup>4</sup></span> and important ecological
impacts<span class="citation"><sup>5</sup></span>.</p>
<p>The function <code><a href="../reference/late_frost.html">late_frost()</a></code> supports the computation of
late-spring frost events. The function counts for the number of freezing
days with minimum temperature below a certain threshold (argument
<code>tfrost</code>). And returns the number of days spanned by frost
events (temperature below <code>tfrost</code>), latency (event with no
freezing temperature but also no accumulation of growing degree-days)
and warming (when growing degree-days are accumulated enabling the
development of the target organism). Additionally the function returns
the first day of the events. The function calculates the growing
degree-days applying the variant b (Eq. 3), which can be adjusted using
the argument <code>equation</code> passed to <code><a href="../reference/GDD.html">GDD()</a></code> as
explained in the later section. The main inputs are a vector with
maximum and minimum temperatures to compute the degree-days, a vector of
dates (argument <code>date</code>), and, if needed, the
<code>tbase</code> and <code>tfrost</code>, set by default to 4 and -2
<span class="math inline">\(^\circ C\)</span>.</p>
</div>
<div class="section level2">
<h2 id="crop-ecology-indices">Crop ecology indices<a class="anchor" aria-label="anchor" href="#crop-ecology-indices"></a>
</h2>
<p>Two functions in <strong>climatrends</strong> are mainly designed to
capture the effects of climate on the development and stress of crop
species, <code><a href="../reference/crop_sensitive.html">crop_sensitive()</a></code> computes indices that aim to
capture the changes in temperature extremes during key phenological
stages (e.g. anthesis), and <code><a href="../reference/ETo.html">ETo()</a></code> computes the reference
evapotranspiration.</p>
<p>The crop ecology indices available in <strong>climatrends</strong>
are described in Table 3. These indices were previously used in crop
models to project the impacts of climate change on crop yield<span class="citation"><sup>4,6</sup></span>. Each index has a default
temperature threshold(s) which can be adjusted by using the arguments
<code>*.threshold</code>. Where the <code>*</code> means the index. For
example, to change the defaults for hts_max (high temperature stress), a
vector with the temperature thresholds is passed through the argument
<code>hts_max.thresholds</code>.</p>
<p>Table 3: Crop sensitive indices computed by climatrends.</p>
<table class="table">
<thead><tr class="header">
<th><strong>Index</strong></th>
<th><strong>Definition</strong></th>
<th><strong>Default thresholds</strong></th>
</tr></thead>
<tbody>
<tr class="odd">
<td>hts_mean</td>
<td>High temperature stress using tmean</td>
<td>32, 35, 38 °C</td>
</tr>
<tr class="even">
<td>hts_max</td>
<td>High temperature stress using tmax</td>
<td>36, 39, 42 °C</td>
</tr>
<tr class="odd">
<td>hse</td>
<td>Heat stress event</td>
<td>31 °C</td>
</tr>
<tr class="even">
<td>hse_ms</td>
<td>Heat stress event for at least two consecutive days</td>
<td>31 °C</td>
</tr>
<tr class="odd">
<td>cdi_mean</td>
<td>Crop duration index</td>
<td>22, 23, 24 °C</td>
</tr>
<tr class="even">
<td>cdi_max</td>
<td>Crop duration index max temperature</td>
<td>27, 28, 29 °C</td>
</tr>
<tr class="odd">
<td>lethal</td>
<td>Lethal temperatures</td>
<td>43, 46, 49 °C</td>
</tr>
</tbody>
</table>
<p>The reference evapotranspiration measures the influence of the
climate on a given plant’s water need<span class="citation"><sup>7</sup></span>. The function <code><a href="../reference/ETo.html">ETo()</a></code>
applies the Blaney-Criddle method, a general theoretical method used
when only air-temperature is available locally. It should be noted that
this method is not very accurate and aims to provide the order of
magnitude of evapotranspitation. The reference evapotranspiration is
calculated using the following equation.</p>
<p>Equation [6]</p>
<p><span class="math display">\[ETo = p \times \left(0.46 \times
\frac{T_{max} + T_{min}}{2} + 8 \right) \times K_c\]</span></p>
<p>Where <span class="math inline">\(p\)</span> is the mean daily
percentage of annual daytime hours, <span class="math inline">\(T_{max}\)</span> is the maximum temperature, <span class="math inline">\(T_{min}\)</span> is the minimum temperature, and
<span class="math inline">\(K_c\)</span> is the factor for organism
water need.</p>
<p>The percentage of daytime hours (<span class="math inline">\(p\)</span>) is calculated internally by the
‘data.frame’ and ‘sf’ methods in <code><a href="../reference/ETo.html">ETo()</a></code> using the given
latitude (taken from the inputted <code>object</code>) and date (taken
from the inputted <code>day.one</code>). It matches the latitude and
date with a table of daylight percentage derived from Brouwer and
Heibloem<span class="citation"><sup>7</sup></span>. The table can be
verified using <code>climatrends:::daylight</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body" line-spacing="2">
<div id="ref-Prentice1992" class="csl-entry">
<div class="csl-left-margin">1. </div>
<div class="csl-right-inline">Prentice, I. C., Cramer, W., Harrison, S. P.,
Leemans, R., <em>et al.</em> <a href="https://doi.org/10.2307/2845499" class="external-link"><span class="nocase">Special
Paper: A Global Biome Model Based on Plant Physiology and Dominance,
Soil Properties and Climate</span></a>. <em>Journal of Biogeography</em>
<strong>19</strong>, 117 (1992).</div>
</div>
<div id="ref-JWu2013" class="csl-entry">
<div class="csl-left-margin">2. </div>
<div class="csl-right-inline">Wu,
J., Guan, D., Yuan, F., Wang, A. &amp; Jin, C. <a href="https://doi.org/10.1371/journal.pone.0065401" class="external-link"><span class="nocase">Soil Temperature Triggers the Onset of Photosynthesis in
Korean Pine</span></a>. <em>PLoS ONE</em> <strong>8</strong>, e65401
(2013).</div>
</div>
<div id="ref-Lambers2008" class="csl-entry">
<div class="csl-left-margin">3. </div>
<div class="csl-right-inline">Lambers, H., Chapin III, F. S. &amp; Pons, T.
L. <em><span>Plant Physiological Ecology</span></em>. 620 (2008). doi:<a href="https://doi.org/10.1007/978-0-387-78341-3" class="external-link">10.1007/978-0-387-78341-3</a>
</div>
</div>
<div id="ref-Trnka2014" class="csl-entry">
<div class="csl-left-margin">4. </div>
<div class="csl-right-inline">Trnka, M., Rötter, R. P., Ruiz-Ramos, M.,
Kersebaum, K. C., <em>et al.</em> <a href="https://doi.org/10.1038/nclimate2242" class="external-link"><span class="nocase">Adverse
weather conditions for European wheat production will become more
frequent with climate change</span></a>. <em>Nature Climate Change</em>
<strong>4</strong>, 637–643 (2014).</div>
</div>
<div id="ref-Zohner2020" class="csl-entry">
<div class="csl-left-margin">5. </div>
<div class="csl-right-inline">Zohner, C. M., Mo, L., Renner, S. S., Svenning,
J.-C., <em>et al.</em> <span class="nocase">Late-spring frost risk
between 1959 and 2017 decreased in North America but increased in Europe
and Asia</span>. <em>Proceedings of the National Academy of
Sciences</em> 201920816 (2020). doi:<a href="https://doi.org/10.1073/pnas.1920816117" class="external-link">10.1073/pnas.1920816117</a>
</div>
</div>
<div id="ref-Challinor2016" class="csl-entry">
<div class="csl-left-margin">6. </div>
<div class="csl-right-inline">Challinor, A. J., Koehler, A.-K.,
Ramirez-Villegas, J., Whitfield, S. &amp; Das, B. <a href="https://doi.org/10.1038/nclimate3061" class="external-link"><span class="nocase">Current
warming will reduce yields unless maize breeding and seed systems adapt
immediately</span></a>. <em>Nature Climate Change</em>
<strong>6</strong>, 954–958 (2016).</div>
</div>
<div id="ref-Brouwer1986" class="csl-entry">
<div class="csl-left-margin">7. </div>
<div class="csl-right-inline">Brouwer, C. &amp; Heibloem, M. <em><span class="nocase">Irrigation water management: Irrigation water
needs</span></em>. (Food; Agriculture Organization of The United
Nations, 1986).</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Kauê de Sousa.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
