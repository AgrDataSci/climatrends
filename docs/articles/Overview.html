<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>climatrends: Precipitation and Temperature Extremes for Climate Variability Analysis • climatrends</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="climatrends: Precipitation and Temperature Extremes for Climate Variability Analysis">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">climatrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Overview.html">climatrends: Precipitation and Temperature Extremes for Climate Variability Analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Overview_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>climatrends: Precipitation and Temperature Extremes for Climate Variability Analysis</h1>
                        <h4 class="author">Kauê de Sousa</h4>
            <address class="author_afil">
      Department of Agricultural Sciences, Inland Norway University, Hamar, Norway; and The Alliance of Bioversity International and CIAT, Rome, Italy<br><h4 class="author">Jacob van Etten</h4>
            <address class="author_afil">
      The Alliance of Bioversity International and CIAT, Rome, Italy<br><h4 class="author">Svein Ø. Solberg</h4>
            <address class="author_afil">
      Department of Agricultural Sciences, Inland Norway University, Hamar, Norway<br><div class="hidden name"><code>Overview.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
    
<p><img align="right" src="logo.png"></p>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>Understanding how climate extremes influences ecological processes is a key approach to provide recommendations for climate adaptation and biodiversity conservation. <strong>climatrends</strong> aims to provide the toolkit to compute extreme precipitation and temperature indices that serves as input for climate models, crop modelling, trends in climate change and ecology. The climate variables available in <strong>climatrends</strong> were previously used to identify climate patterns in crop growing cycles<span class="citation"><sup>1</sup></span>, regional climate change assessment<span class="citation"><sup>2</sup></span>, crowdsourcing citizen science in agriculture<span class="citation"><sup>3</sup></span> and comparison between perceptions to climate change and satellite observations<span class="citation"><sup>4</sup></span>.</p>
</div>
<div id="source-of-data" class="section level1">
<h1 class="hasAnchor">
<a href="#source-of-data" class="anchor"></a>Source of data</h1>
<p>By default <strong>climatrends</strong> uses <a href="https://power.larc.nasa.gov/">NASA POWER</a> to compute the indices via the R package <a href="https://CRAN.R-project.org/package=nasapower">nasapower</a><span class="citation"><sup>5</sup></span>. By providing the target dates and the geographic information, <strong>climatrends</strong> sends an internal call to <em>nasapower</em> to request the time series data and compute the environmental indices. This process do not requires much computer capacity but requires a persistent internet connection. NASA POWER, however, has a low grid resolution (0.5 arc-degree) and could not provide the expected results for ecological interactions in a narrow geographical range.</p>
<p>Other option relies in providing the climate data locally as a <code>matrix</code> or <code>array</code> (please see details below), using, for example, the function <code>extract()</code> from the package <a href="https://CRAN.R-project.org/package=raster">raster</a><span class="citation"><sup>6</sup></span>. The environmental data can be computed using inputted data from CHIRPS<span class="citation"><sup>7</sup></span> for rainfall, and MODIS<span class="citation"><sup>8</sup></span> for land surface temperature. These databases are free and publicly available sources of global coverage with high resolution (0.05 arc-degree), but may require significant local storage capacity. MODIS data also requires some work to reduce noise and gap filling.</p>
</div>
<div id="usage" class="section level1">
<h1 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h1>
<div id="temperature" class="section level2">
<h2 class="hasAnchor">
<a href="#temperature" class="anchor"></a>Temperature</h2>
<p>The function <code><a href="../reference/temperature.html">temperature()</a></code> has as the basic input data an <code>object</code> of class <code>data.frame</code> with geographic information (lonlat) or an <code>array</code> with day and night temperature (when provided locally) and a vector of class <code>Date</code> for the first day that will be taken into account for the indices. The duration from where the environmental indices will be computed is defined by the argument <code>span</code> which can be a single integer that takes into account a single timespan for all tricot experiments or a vector indicating the timespan for each point.</p>
<p>Here we generate some random points within the Innlandet county in Norway from May-2015:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">6</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a>lonlat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">lon =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">5</span>, <span class="fl">8.3</span>, <span class="dv">12</span>),</span>
<span id="cb1-3"><a href="#cb1-3"></a>                     <span class="dt">lat =</span> <span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">5</span>, <span class="dv">60</span>, <span class="fl">62.3</span>))</span>
<span id="cb1-4"><a href="#cb1-4"></a></span>
<span id="cb1-5"><a href="#cb1-5"></a>date &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="st">"2015-05-01"</span>, <span class="dt">format =</span> <span class="st">"%Y-%m-%d"</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>temp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/temperature.html">temperature</a></span>(lonlat, <span class="dt">day.one =</span> date, <span class="dt">span =</span> <span class="dv">50</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(temp)</span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; # A tibble: 5 x 8</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt;   maxDT  minDT maxNT  minNT   DTR    SU    TR   CFD</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">#&gt; 1  12.8 -0.580  3.61 -10.8   7.36     0     0    13</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">#&gt; 2  13.4  0.66   3.84  -7.6   7.02     0     0    12</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">#&gt; 3  10.7 -1.48   2.43 -11.3   7.12     0     0    40</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">#&gt; 4  14.1  1.53   3.94  -6.85  8.44     0     0    12</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">#&gt; 5  19.6  5.82   8.24  -2.4   8.23     0     0     1</span></span></code></pre></div>
<p>With the argument <code>timeseries = TRUE</code>, <code><a href="../reference/temperature.html">temperature()</a></code> returns the indices for a time series based on <code>intervals</code>. Here we compute the indices for intervals of 7 days:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>temp2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/temperature.html">temperature</a></span>(lonlat,</span>
<span id="cb2-2"><a href="#cb2-2"></a>                     <span class="dt">day.one =</span> date,</span>
<span id="cb2-3"><a href="#cb2-3"></a>                     <span class="dt">span =</span> <span class="dv">50</span>, </span>
<span id="cb2-4"><a href="#cb2-4"></a>                     <span class="dt">timeseries =</span> <span class="ot">TRUE</span>,</span>
<span id="cb2-5"><a href="#cb2-5"></a>                     <span class="dt">intervals =</span> <span class="dv">7</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(temp2)</span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; # A tibble: 6 x 4</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt;      id date       index   value</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;   &lt;int&gt; &lt;date&gt;     &lt;chr&gt;   &lt;dbl&gt;</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; 1     1 2015-05-01 maxDT   9.7  </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; 2     1 2015-05-01 minDT  -0.580</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; 3     1 2015-05-01 maxNT   2.42 </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; 4     1 2015-05-01 minNT -10.8  </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; 5     1 2015-05-01 DTR     8.19 </span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; 6     1 2015-05-01 SU      0</span></span></code></pre></div>
</div>
<div id="growing-degree-days" class="section level2">
<h2 class="hasAnchor">
<a href="#growing-degree-days" class="anchor"></a>Growing degree-days</h2>
<p>Growing degree-days is a heuristic tool in phenology, it is a measure of heat accumulation used to predict plant and animal development rates<span class="citation"><sup>9</sup></span>. With the function <code><a href="../reference/GDD.html">GDD()</a></code> we can compute the growing degree-days to assess the degree-days required by an certain organism during a certain season. Also, this index can be used as an estimate for the timespan to compute the temperature and precipitation indices. Here we compute the days to reach the growing degree-days for a certain organism which requires 200 degree-days with a <code>base = 5</code> from <code>day.one</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>gdd &lt;-<span class="st"> </span><span class="kw"><a href="../reference/GDD.html">GDD</a></span>(lonlat, </span>
<span id="cb3-2"><a href="#cb3-2"></a>           <span class="dt">day.one =</span> date,</span>
<span id="cb3-3"><a href="#cb3-3"></a>           <span class="dt">degree.days =</span> <span class="dv">200</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>           <span class="dt">base =</span> <span class="dv">5</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(gdd)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">#&gt; # A tibble: 5 x 1</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">#&gt;     GDD</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">#&gt;   &lt;int&gt;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">#&gt; 1   120</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">#&gt; 2   112</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">#&gt; 3   150</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">#&gt; 4   105</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">#&gt; 5    56</span></span></code></pre></div>
<p>Then, these growing degree-days can be applied as timespan to compute the temperature indices across the season:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>temp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/temperature.html">temperature</a></span>(lonlat, </span>
<span id="cb4-2"><a href="#cb4-2"></a>                    <span class="dt">day.one =</span> date, </span>
<span id="cb4-3"><a href="#cb4-3"></a>                    <span class="dt">span =</span> gdd)</span>
<span id="cb4-4"><a href="#cb4-4"></a></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(temp)</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">#&gt; # A tibble: 5 x 8</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">#&gt;   maxDT  minDT maxNT  minNT   DTR    SU    TR   CFD</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">#&gt; 1  22.3 -0.580  11.4 -10.8   8.05     0     0    13</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">#&gt; 2  21.6  0.66   11.8  -7.6   7.43     0     0    12</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">#&gt; 3  20.8 -1.48   11.1 -11.3   7.59     0     0    40</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">#&gt; 4  22.3  1.53   13.0  -6.85  8.72     0     0    12</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">#&gt; 5  19.6  5.82   10.5  -2.4   8.20     0     0     1</span></span></code></pre></div>
</div>
<div id="rainfall" class="section level2">
<h2 class="hasAnchor">
<a href="#rainfall" class="anchor"></a>Rainfall</h2>
<p>Precipitation indices are computed in the same way as the temperature indices using the function <code><a href="../reference/rainfall.html">rainfall()</a></code>. Here we use the NASA POWER data with a timespan defined by the growing degree-days.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>rain &lt;-<span class="st"> </span><span class="kw"><a href="../reference/rainfall.html">rainfall</a></span>(lonlat, </span>
<span id="cb5-2"><a href="#cb5-2"></a>                 <span class="dt">day.one =</span> date,</span>
<span id="cb5-3"><a href="#cb5-3"></a>                 <span class="dt">span =</span> gdd)</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(rain)</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt; # A tibble: 5 x 10</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;    MLDS  MLWS R10mm R20mm Rx1day Rx5day  R95p  R99p Rtotal  SDII</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;   &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; 1    13    13     8     2   26.8   55.6 107.   50.7   495.  4.23</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; 2     8    17     7     2   23.0   46.3 104.   44.8   473.  3.81</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; 3    12    14    10     3   37.0   72.0 169.   63.7   586.  6.04</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; 4     5     6    12     1   30.6   47.0  99.3  46.8   397.  3.61</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; 5     6     6     3     0   17.6   41.3  42.4  17.6   187.  1.48</span></span></code></pre></div>
<p>The function <code><a href="../reference/rainfall.html">rainfall()</a></code> also compute indices for a time series:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="../reference/rainfall.html">rainfall</a></span>(lonlat,</span>
<span id="cb6-2"><a href="#cb6-2"></a>         <span class="dt">day.one =</span> date,</span>
<span id="cb6-3"><a href="#cb6-3"></a>         <span class="dt">span =</span> gdd,</span>
<span id="cb6-4"><a href="#cb6-4"></a>         <span class="dt">timeseries =</span> <span class="ot">TRUE</span>,</span>
<span id="cb6-5"><a href="#cb6-5"></a>         <span class="dt">intervals =</span> <span class="dv">15</span>)</span></code></pre></div>
<p>Another feature in <code><a href="../reference/rainfall.html">rainfall()</a></code> is that it enables the indices to be calculated from some days before <code>day.one</code>. This is important for case studies where a residual precipitation must be taken into account. To do so, we use the argument <code>days.before</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../reference/rainfall.html">rainfall</a></span>(lonlat,</span>
<span id="cb7-2"><a href="#cb7-2"></a>         <span class="dt">day.one =</span> date,</span>
<span id="cb7-3"><a href="#cb7-3"></a>         <span class="dt">span =</span> gdd,</span>
<span id="cb7-4"><a href="#cb7-4"></a>         <span class="dt">days.before =</span> <span class="dv">15</span>)</span></code></pre></div>
</div>
<div id="evapotranspiration" class="section level2">
<h2 class="hasAnchor">
<a href="#evapotranspiration" class="anchor"></a>Evapotranspiration</h2>
<p>Evapotranspiration can be defined as the sum of evaporation and plant transpiration from the Earth’s surface to the atmosphere. This is also an important index to include in models for ecological interactions. In **climatrends* this index can be calculate using the function <code><a href="../reference/ETo.html">ETo()</a></code> which computes the evapotranspiration based on the Blaney-Criddle method<span class="citation"><sup>10</sup></span>, an ideal equation when only air-temperature data sets are available for a site.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>eto &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ETo.html">ETo</a></span>(lonlat, </span>
<span id="cb8-2"><a href="#cb8-2"></a>           <span class="dt">day.one =</span> date,</span>
<span id="cb8-3"><a href="#cb8-3"></a>           <span class="dt">span =</span> gdd,</span>
<span id="cb8-4"><a href="#cb8-4"></a>           <span class="dt">lat =</span> lonlat[[<span class="st">"lat"</span>]])</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(eto)</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">#&gt; # A tibble: 5 x 1</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co">#&gt;     ETo</span></span>
<span id="cb8-9"><a href="#cb8-9"></a><span class="co">#&gt;   &lt;dbl&gt;</span></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co">#&gt; 1  4.21</span></span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="co">#&gt; 2  4.24</span></span>
<span id="cb8-12"><a href="#cb8-12"></a><span class="co">#&gt; 3  3.98</span></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">#&gt; 4  4.25</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">#&gt; 5  4.54</span></span></code></pre></div>
</div>
</div>
<div id="compute-indices-from-local-databases" class="section level1">
<h1 class="hasAnchor">
<a href="#compute-indices-from-local-databases" class="anchor"></a>Compute indices from local databases</h1>
<p>When using data from local databases, such as CHIRPS or MODIS. The inputted <code>object</code> must be provided in a specific format. This is how the <code>object</code> should be organised for <code><a href="../reference/rainfall.html">rainfall()</a></code>. A matrix where column names are the days as extracted from CHIRPS. Let’s create some random values to simulate the input behaviour.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">999</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a>rain &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">150</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="dt">ncol =</span> <span class="dv">15</span>, <span class="dt">nrow =</span> <span class="dv">10</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(rain)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="dv">16005</span><span class="op">:</span><span class="dv">16019</span>, <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>))</span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a>dates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">10</span>, <span class="dv">16005</span>, <span class="dv">16008</span>), <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb9-6"><a href="#cb9-6"></a></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="kw"><a href="../reference/rainfall.html">rainfall</a></span>(rain, </span>
<span id="cb9-8"><a href="#cb9-8"></a>         <span class="dt">day.one =</span> dates,</span>
<span id="cb9-9"><a href="#cb9-9"></a>         <span class="dt">span =</span> <span class="dv">10</span>)</span></code></pre></div>
<p>The same for <code><a href="../reference/temperature.html">temperature()</a></code>. But in that case the inputted <code>object</code> is an array with two layers, the first for the day temperature and the second for the night temperature.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">888</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>day &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">150</span>, <span class="dv">27</span>, <span class="dv">35</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>night &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">150</span>, <span class="dv">20</span>, <span class="dv">25</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a>mod &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/array.html">array</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(day, night), <span class="dt">dim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="dv">2</span>))</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="kw"><a href="https://rdrr.io/r/base/dimnames.html">dimnames</a></span>(mod)[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="dv">16005</span><span class="op">:</span><span class="dv">16019</span>, <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>))</span>
<span id="cb10-7"><a href="#cb10-7"></a></span>
<span id="cb10-8"><a href="#cb10-8"></a>dates &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">10</span>, <span class="dv">16005</span>, <span class="dv">16008</span>), <span class="dt">origin =</span> <span class="st">"1970-01-01"</span>)</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="kw"><a href="../reference/temperature.html">temperature</a></span>(mod,</span>
<span id="cb10-11"><a href="#cb10-11"></a>            <span class="dt">day.one =</span> dates,</span>
<span id="cb10-12"><a href="#cb10-12"></a>            <span class="dt">span =</span> <span class="dv">10</span>)</span></code></pre></div>
</div>
<div id="indices" class="section level1">
<h1 class="hasAnchor">
<a href="#indices" class="anchor"></a>Indices</h1>
<p><strong>climatrends</strong> computes 18 temperature and precipitation indices:</p>
<table class="table">
<colgroup>
<col width="7%">
<col width="84%">
<col width="8%">
</colgroup>
<thead><tr class="header">
<th align="left">Index</th>
<th align="left">Definition</th>
<th align="left">Unit</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">maxDT</td>
<td align="left">maximun day temperature</td>
<td align="left">°C</td>
</tr>
<tr class="even">
<td align="left">minDT</td>
<td align="left">minimum day temperature</td>
<td align="left">°C</td>
</tr>
<tr class="odd">
<td align="left">maxNT</td>
<td align="left">maximun night temperature</td>
<td align="left">°C</td>
</tr>
<tr class="even">
<td align="left">minNT</td>
<td align="left">minimum night temperature</td>
<td align="left">°C</td>
</tr>
<tr class="odd">
<td align="left">DTR</td>
<td align="left">diurnal temperature range (mean difference between DT and NT)</td>
<td align="left">°C</td>
</tr>
<tr class="even">
<td align="left">SU</td>
<td align="left">summer days, number of days with maximum temperature &gt; 30 °C</td>
<td align="left">days</td>
</tr>
<tr class="odd">
<td align="left">TR</td>
<td align="left">tropical nights, number of nights with maximum temperature &gt; 25 °C</td>
<td align="left">days</td>
</tr>
<tr class="even">
<td align="left">CFD</td>
<td align="left">consecutive frosty days, number of days with temperature &lt; 0 °C</td>
<td align="left">days</td>
</tr>
<tr class="odd">
<td align="left">MLDS</td>
<td align="left">maximum length of consecutive dry day, rain &lt; 1 mm</td>
<td align="left">days</td>
</tr>
<tr class="even">
<td align="left">MLWS</td>
<td align="left">maximum length of consecutive wet day, rain &gt;= 1 mm</td>
<td align="left">days</td>
</tr>
<tr class="odd">
<td align="left">R10mm</td>
<td align="left">heavy precipitation days 10 &gt;= rain &lt; 20 mm</td>
<td align="left">days</td>
</tr>
<tr class="even">
<td align="left">R20mm</td>
<td align="left">very heavy precipitation days rain &gt;= 20</td>
<td align="left">days</td>
</tr>
<tr class="odd">
<td align="left">Rx1day</td>
<td align="left">maximum 1-day precipitation</td>
<td align="left">mm</td>
</tr>
<tr class="even">
<td align="left">Rx5day</td>
<td align="left">maximum 5-day precipitation</td>
<td align="left">mm</td>
</tr>
<tr class="odd">
<td align="left">R95p</td>
<td align="left">total precipitation when rain &gt; 95th percentile</td>
<td align="left">mm</td>
</tr>
<tr class="even">
<td align="left">R99p</td>
<td align="left">total precipitation when rain &gt; 99th percentile</td>
<td align="left">mm</td>
</tr>
<tr class="odd">
<td align="left">Rtotal</td>
<td align="left">total precipitation in wet days, rain &gt;= 1 mm</td>
<td align="left">mm</td>
</tr>
<tr class="even">
<td align="left">SDII</td>
<td align="left">simple daily intensity index, total precipitation divided by the number of wet days</td>
<td align="left">mm/days</td>
</tr>
</tbody>
</table>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Kehel2016">
<p>1. Kehel, Z., Crossa, J. &amp; Reynolds, M. Identifying Climate Patterns during the Crop-Growing Cycle from 30 Years of CIMMYT Elite Spring Wheat International Yield Trials. in <em>Applied mathematics and omics to assess crop genetic resources for climate change adaptive traits</em> (eds. Bari, A., Damania, A. B., Mackay, M. &amp; Dayanandan, S.) 151–174 (CRC Press, 2016).</p>
</div>
<div id="ref-Aguilar2005">
<p>2. Aguilar, E., Peterson, T. C., Obando, P. R. &amp; Frutos, R. <em>et al.</em> Changes in precipitation and temperature extremes in Central America and northern South America, 1961–2003. <em>Journal of Geophysical Research</em> <strong>110</strong>, D23107 (2005).</p>
</div>
<div id="ref-vanEtten2019">
<p>3. van Etten, J., de Sousa, K., Aguilar, A. &amp; Barrios, M. <em>et al.</em> Crop variety management for climate adaptation supported by citizen science. <em>Proceedings of the National Academy of Sciences</em> <strong>116</strong>, 4194–4199 (2019).</p>
</div>
<div id="ref-DeSousa2018">
<p>4. de Sousa, K., Casanoves, F., Sellare, J. &amp; Ospina, A. <em>et al.</em> How climate awareness influences farmers’ adaptation decisions in Central America? <em>Journal of Rural Studies</em> <strong>64</strong>, 11–19 (2018).</p>
</div>
<div id="ref-Sparks2018">
<p>5. Sparks, A. H. nasapower: A NASA POWER Global Meteorology, Surface Solar Energy and Climatology Data Client for R. <em>Journal of Open Source Software</em> <strong>3</strong>, 1035 (2018).</p>
</div>
<div id="ref-Hijmans2015">
<p>6. Hijmans, R. J., van Etten, J., Cheng, J. &amp; Mattiuzzi, M. <em>et al.</em> raster: Geographic Data Analysis and Modeling. R package version 2.5-8. (2015).</p>
</div>
<div id="ref-Funk2015">
<p>7. Funk, C., Peterson, P., Landsfeld, M. &amp; Pedreros, D. <em>et al.</em> The climate hazards infrared precipitation with stations—a new environmental record for monitoring extremes. <em>Scientific Data</em> <strong>2</strong>, 150066 (2015).</p>
</div>
<div id="ref-Wan2015">
<p>8. Wan, Z., Hook, S. &amp; Hulley, G. MYD11A1 MODIS/Aqua Land Surface Temperature/Emissivity Daily L3 Global 1km SIN Grid V006 [Data set]. <em>NASA EOSDIS LP DAAC</em> (2015). doi:<a href="https://doi.org/10.5067/MODIS/MYD11A1.006">10.5067/MODIS/MYD11A1.006</a></p>
</div>
<div id="ref-Prentice1992">
<p>9. Prentice, I. C., Cramer, W., Harrison, S. P. &amp; Leemans, R. <em>et al.</em> Special Paper: A Global Biome Model Based on Plant Physiology and Dominance, Soil Properties and Climate. <em>Journal of Biogeography</em> <strong>19</strong>, 117 (1992).</p>
</div>
<div id="ref-Brouwer1986">
<p>10. Brouwer, C. &amp; Heibloem, M. <em>Irrigation water management: Irrigation water needs</em>. (Food; Agriculture Organization of The United Nations, 1986).</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#summary">Summary</a></li>
      <li><a href="#source-of-data">Source of data</a></li>
      <li>
<a href="#usage">Usage</a>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#temperature">Temperature</a></li>
      <li><a href="#growing-degree-days">Growing degree-days</a></li>
      <li><a href="#rainfall">Rainfall</a></li>
      <li><a href="#evapotranspiration">Evapotranspiration</a></li>
      </ul>
</li>
      <li><a href="#compute-indices-from-local-databases">Compute indices from local databases</a></li>
      <li>
<a href="#indices">Indices</a>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#references">References</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kaue de Sousa, Jacob van Etten, Svein Solberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
